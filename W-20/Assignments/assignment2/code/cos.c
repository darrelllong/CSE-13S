#include "cos.h"
#include <math.h>

// Written by DDEL

double Cos(double x) {
  // Normalize –2π ≤ x ≤ 2π
  x = fmod(x, 2.0 * M_PI);
  // 17 term Padé approximant
  double n =
      (233733954452448617511531023645533493577768960000.0 +
       x * x * (-114269935241792828593210896950499417562675200000.0 +
       x * x * ( 8454928015291387732074266532904505548380672000.0 +
       x * x * (-223633513824454113690920636167756712697600000.0 +
       x * x * ( 2768703405521362258317703470942604295097600.0 +
       x * x * (-18009237589434518277575370108385658736000.0 +
       x * x * ( 63724438950432108761721583505233450080.0 +
       x * x * (-117071511329303129411051152664754000.0 +
                 88555612088268453352055067469523.0 * x * x))))))));
  double d =
      (233733954452448617511531023645533493577768960000.0 +
       x * x * (2597041984431480162554614872267329226209280000.0 +
       x * x * (14534238655102083704447983807607929078272000.0 +
       x * x * (54015113519445709765268899260608496384000.0 +
       x * x * (147364442364155066776323466153142457600.0 +
       x * x * (305938843489986501963241647984009600.0 +
       x * x * (478745282533904215906776562810080.0 +
       x * x * (524970227826487957177863426960.0 +
                315071778950855885168016323.0 * x * x))))))));
  return n / d;
}
