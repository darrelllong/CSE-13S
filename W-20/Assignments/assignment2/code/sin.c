#include "sin.h"
#include <math.h>

// Written by DDEL

double Sin(double x) {
    // Normalize –2π ≤ x ≤ 2π
    x = fmod(x, 2.0 * M_PI);
    // 17 term Padé approximant
    double n =
    (x *     ( 57828920795643563975499605577896522721894516695040000.0 +
              x * x * (-9043391472275269780714387149296370169813546383360000.0 +
              x * x * ( 385846343114084908761955730262486848794451953152000.0 +
              x * x * (-7018152388055659489803429450576784126723621632000.0 +
              x * x * ( 65186705285311601343595013455383632198000736000.0 +
              x * x * (-335313110786511542878126683344786959795547520.0 +
              x * x * ( 972385828035106690717007134524653036979360.0 +
              x * x * (-1502689094832213435936046050121649006736.0 +
                        975427620658093848827309139414158497.0 * x * x)))))))));
    double d =
    (57828920795643563975499605577896522721894516695040000.0 +
     x * x * (594761993665324215202213780353050283835539732480000.0 +
     x * x * (3065668761275911499827980505524206751254269440000.0 +
     x * x * (10434679637140628621596427936855649438170880000.0 +
     x * x * (25907882907744318170976640014711828986208000.0 +
     x * x * (48596832167862212805779793213095236049280.0 +
     x * x * (68138672673534221733247152981225764640.0 +
     x * x * (66300780346683777001333679042690640.0 +
              34904845916943747530797468561617.0 * x * x))))))));
    return n / d;
}
