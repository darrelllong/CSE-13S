#include "tan.h"
#include <math.h>

// Written by DDEL

double Tan(double x) {
  // Normalize –π/2 ≤ x ≤ π/2
  x = fmod(x, M_PI / 2.0);
  // 17 term Padé approximant
  double n =
      (x * (6332659870762850625 + x * x * (-959493919812553125 + x * x * (37554385678684875 +
       x * x * (-581419060472250 + x * x * (4141161399375 + x * x * (-14054850810 +
       x * x * (21366450 + x * x * (-11628 + x * x)))))))));
  double d =
      (6332659870762850625 +
       x * x * (-3070380543400170000 + x * x * (216659917377028125 +
       x * x * (-5179915266025500 + x * x * (53835098191875 +
       x * x * (-265034329560 + x * x * (611080470 + x * x * (-581400 + 153 * x * x))))))));
  return n / d;
}
